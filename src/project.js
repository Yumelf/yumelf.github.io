__require=function t(e,o,i){function n(a,s){if(!o[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var p="function"==typeof __require&&__require;if(!s&&p)return p(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+a+"'")}}var l=o[a]={exports:{}};e[a][0].call(l.exports,function(t){return n(e[a][1][t]||t)},l,l.exports,t,e,o,i)}return o[a].exports}for(var c="function"==typeof __require&&__require,a=0;a<i.length;a++)n(i[a]);return n}({Audio:[function(t,e,o){"use strict";cc._RF.push(e,"88c15SoZ8JK04NGqQ0Hkj2W","Audio");cc._RF.pop()},{}],Beat:[function(t,e,o){"use strict";cc._RF.push(e,"773b2dLSY1M3pvhLHGV+KEW","Beat"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Game"),n=function(){function t(e,o){this.node=null,this.pipeline=null,this.type="don",t.Pool.size()>0?this.node=t.Pool.get():this.node=cc.instantiate(t.Prefab),this.node.color="don"==e?cc.color(247,73,38):cc.color(106,192,193),this.type=e,this.pipeline=o,this.node.parent=this.pipeline.line,this.node.opacity=255}return t.prototype.born=function(){var t=this,e=cc.view.getVisibleSize().width+35;this.node.position=cc.v2(e,94),this.node.runAction(cc.sequence([cc.moveTo((e+35-325)/i.Game.SPEED,290,94),cc.callFunc(function(){t.pipeline.exit(),t.recycle()})])),this.node.getComponent(cc.Animation).play("combo").time=Math.round((new Date).getMilliseconds()%400/1e3*12)},t.prototype.done=function(){var t=this;this.node.stopAllActions();var e=cc.view.getVisibleSize().width-55-39;this.node.runAction(cc.sequence([cc.jumpTo(.6,e,211,240,1),cc.callFunc(function(){t.pipeline.fade()}),cc.fadeOut(.5),cc.callFunc(function(){t.recycle()})]))},t.prototype.beat=function(e){var o=this;if(this.type.slice(0,3)==e.slice(0,3)){var n=Math.abs(this.node.position.x-409);return n<t.GOOD_RANGE?(this.pipeline.good(),void this.done()):n<t.OK_RANGE?(this.pipeline.ok(),void this.done()):n<t.BAD_RANGE?(this.pipeline.bad(),this.node.stopAllActions(),void this.node.runAction(cc.sequence([cc.moveTo((this.node.x+35-325)/i.Game.SPEED,290,94),cc.callFunc(function(){o.recycle()})]))):void 0}},t.prototype.recycle=function(){t.Pool.put(this.node)},t.Prefab=null,t.Pool=new cc.NodePool,t.BAD_RANGE=80,t.OK_RANGE=60,t.GOOD_RANGE=20,t}();o.Beat=n;var c=function(){function t(e,o){this.type="renda",this.node=null,this.pipeline=null,t.Pool.size()>0?this.node=t.Pool.get():this.node=cc.instantiate(t.Prefab),this.pipeline=o,this.node.parent=this.pipeline.line,this.node.width=e}return t.prototype.born=function(){var t=this,e=cc.view.getVisibleSize().width;this.node.position=cc.v2(e,94),this.node.runAction(cc.sequence([cc.moveTo((e+this.node.width/2-325)/i.Game.SPEED,325-this.node.width/2,94),cc.callFunc(function(){t.pipeline.exit(),t.recycle()})]))},t.prototype.beat=function(t){if(!(this.node.position.x>409||this.node.position.x+this.node.width/2<409)){this.pipeline.renda();var e=new n(t.split("_")[0],this.pipeline);e.node.position=cc.v2(409,94),e.done()}},t.prototype.recycle=function(){t.Pool.put(this.node)},t.Prefab=null,t.Pool=new cc.NodePool,t}();o.Renda=c;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(n);o.Big=a,cc._RF.pop()},{"./Game":"Game"}],Chibi:[function(t,e,o){"use strict";cc._RF.push(e,"6272bGXWwxPrIM7GQrDZtJi","Chibi"),Object.defineProperty(o,"__esModule",{value:!0});var i={};function n(t){for(var e=(cc.view.getVisibleSize().width-325+40)/8,o=[],n=0;n<=8;n++)o.push(cc.v2(325+n*e,n%2?225:280));t.runAction(cc.sequence([cc.cardinalSplineTo(2,o,0),cc.callFunc(function(){(function(t){i[t.name].put(t)})(t)})]))}var c={takoyaki:function(t){t.getComponent(cc.Animation).play(["sosu","shoyu","sosu_tsumayoji","shoyu_tsumayoji"][Math.max(0,Math.floor(4*Math.random()-.1))]),n(t)},tamashi:function(t){var e=t.getComponent(cc.Animation);e.play("grow"),e.scheduleOnce(function(){e.play("loop")},1),n(t)}};o.Chibi={prefab:{},create:function(t,e){t in i||(i[t]=new cc.NodePool);var n=i[t].size()>0?i[t].get():cc.instantiate(o.Chibi.prefab[t]);c[t](n),n.parent=e}},cc._RF.pop()},{}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"6a41b/Vj4tNrYWl/hCxHzUH","Game"),Object.defineProperty(o,"__esModule",{value:!0});o.Game={SPEED:360,song:null},cc._RF.pop()},{}],main:[function(t,e,o){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","main"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Chibi"),n=t("./Beat"),c=t("./Game"),a=cc._decorator,s=a.ccclass,r=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nod=null,e.beatPrefab=null,e.rendaPrefab=null,e.takoyakiPrefab=null,e.tamashiPrefab=null,e.demo=null,e}return __extends(e,t),e.prototype.onLoad=function(){n.Beat.Prefab=this.beatPrefab,n.Renda.Prefab=this.rendaPrefab,i.Chibi.prefab.takoyaki=this.takoyakiPrefab,i.Chibi.prefab.tamashi=this.tamashiPrefab,this.nod.runAction(cc.sequence([cc.moveBy(4,-332.6,0),cc.moveBy(0,332.6,0)]).repeatForever()),c.Game.song=this.demo},__decorate([r(cc.Node)],e.prototype,"nod",void 0),__decorate([r(cc.Prefab)],e.prototype,"beatPrefab",void 0),__decorate([r(cc.Prefab)],e.prototype,"rendaPrefab",void 0),__decorate([r(cc.Prefab)],e.prototype,"takoyakiPrefab",void 0),__decorate([r(cc.Prefab)],e.prototype,"tamashiPrefab",void 0),__decorate([r(cc.AudioSource)],e.prototype,"demo",void 0),e=__decorate([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Beat":"Beat","./Chibi":"Chibi","./Game":"Game"}],pipeline:[function(t,e,o){"use strict";cc._RF.push(e,"0a4b27PV9lAsZvkNDkH39Ji","pipeline"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,c=i.property,a=t("./Chibi"),s=t("./Beat"),r=t("./Game"),p=0,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.line=null,e.shader=null,e.result=null,e.scoreAnim=null,e.scoreTotal=null,e.scorePlus=null,e.rendaAnim=null,e.rendaTotal=null,e.comboAnim=null,e.comboTotal=null,e.fadeAnim=null,e.beats=[],e.score=0,e.rendas=0,e.combos=0,e.launched=!1,e}return __extends(e,t),e.prototype.beat=function(t){this.launched?(this.shader.stopAllActions(),this.shader.opacity=80,this.shader.color="don"==t.split("_")[0]?cc.color(247,73,38):cc.color(106,192,193),this.shader.runAction(cc.fadeOut(.3)),this.beats[0]&&this.beats[0].beat(t)):this.launch()},e.prototype.plus=function(t){this.score+=t,this.scorePlus.string=String(t),this.scoreTotal.string=String(this.score),this.scoreAnim.play("score_plus")},e.prototype.comboPlus=function(){this.combos++,this.combos>=10&&(this.comboTotal.node.opacity=255,this.comboAnim.play("combo_plus"),this.comboTotal.string=String(this.combos))},e.prototype.comboClear=function(){0!=this.combos&&(this.combos=0,this.comboTotal.node.opacity=0)},e.prototype.ok=function(){this.plus(100),this.comboPlus(),this.result.play("ok"),a.Chibi.create("takoyaki",this.line),this.beats.shift()},e.prototype.bad=function(){this.comboClear(),this.result.play("bad"),a.Chibi.create("tamashi",this.line),this.beats.shift()},e.prototype.good=function(){this.plus(200),this.comboPlus(),this.result.play("good"),a.Chibi.create("takoyaki",this.line),this.beats.shift()},e.prototype.renda=function(){this.plus(100),0==this.rendas?this.rendaAnim.play("renda_fan").wrapMode=cc.WrapMode.Normal:this.rendaAnim.play("renda_plus"),this.rendas++,this.rendaTotal.string=String(this.rendas),this.unschedule(this.hideRenda),this.scheduleOnce(this.hideRenda,1)},e.prototype.exit=function(){"renda"==this.beats[0].type||(this.comboClear(),a.Chibi.create("tamashi",this.line)),this.beats.shift()},e.prototype.fade=function(){this.fadeAnim.play("fade")},e.prototype.hideRenda=function(){this.rendaAnim.play("renda_fan").wrapMode=cc.WrapMode.Reverse,this.rendas=0},e.prototype.onLoad=function(){this.score=0,this.scoreTotal.string=String(0),this.rendas=0,this.rendaAnim.node.opacity=0,this.combos=0,this.comboAnim.node.opacity=0},e.prototype.launch=function(){var t=this;this.launched=!0,this.schedule(function(){if(++p%16==8){var e=new s.Renda(1600,t);return t.beats.push(e),void e.born()}if(!(p%16>4)){var o=null;switch(p%5){case 1:case 3:case 4:o=new s.Beat("don",t);break;case 0:o=new s.Beat("katsu",t);break;case 2:return}t.beats.push(o),o.born()}},.5),r.Game.song.play()},__decorate([c(cc.Node)],e.prototype,"line",void 0),__decorate([c(cc.Node)],e.prototype,"shader",void 0),__decorate([c(cc.Animation)],e.prototype,"result",void 0),__decorate([c(cc.Animation)],e.prototype,"scoreAnim",void 0),__decorate([c(cc.Label)],e.prototype,"scoreTotal",void 0),__decorate([c(cc.Label)],e.prototype,"scorePlus",void 0),__decorate([c(cc.Animation)],e.prototype,"rendaAnim",void 0),__decorate([c(cc.Label)],e.prototype,"rendaTotal",void 0),__decorate([c(cc.Animation)],e.prototype,"comboAnim",void 0),__decorate([c(cc.Label)],e.prototype,"comboTotal",void 0),__decorate([c(cc.Animation)],e.prototype,"fadeAnim",void 0),e=__decorate([n],e)}(cc.Component);o.Pipeline=l,cc._RF.pop()},{"./Beat":"Beat","./Chibi":"Chibi","./Game":"Game"}],taiko:[function(t,e,o){"use strict";cc._RF.push(e,"8f87e2O75FPmZ4crphzlfVZ","taiko"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./pipeline"),n=cc._decorator,c=n.ccclass,a=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.don_left=null,e.don_right=null,e.katsu_left=null,e.katsu_right=null,e.don=null,e.katsu=null,e.bg=null,e.beat=null,e.pipeline=null,e}return __extends(e,t),e.prototype.onEnable=function(){this.don_left.opacity=0,this.don_right.opacity=0,this.katsu_left.opacity=0,this.katsu_right.opacity=0,this.node.on(cc.Node.EventType.TOUCH_START,this.taikoClick,this),this.bg.on(cc.Node.EventType.TOUCH_START,this.bgClick,this)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.taikoClick,this),this.bg.off(cc.Node.EventType.TOUCH_START,this.bgClick,this)},e.prototype.convertPos=function(t){var e=cc.view.getVisibleSize();return cc.v2(t.x-e.width/2,t.y)},e.prototype.beatDon=function(t){cc.audioEngine.play(this.don,!1,.5),t>0?(this.don_right.opacity=190,this.don_right.runAction(cc.fadeOut(.25)),this.pipeline.beat("don_right")):(this.don_left.opacity=190,this.don_left.runAction(cc.fadeOut(.25)),this.pipeline.beat("don_left"))},e.prototype.beatKstsu=function(t){cc.audioEngine.play(this.katsu,!1,.5),t>0?(this.katsu_right.opacity=190,this.katsu_right.runAction(cc.fadeOut(.25)),this.pipeline.beat("katsu_right")):(this.katsu_left.opacity=190,this.katsu_left.runAction(cc.fadeOut(.25)),this.pipeline.beat("katsu_left"))},e.prototype.taikoClick=function(t){t.stopPropagation(),this.beat.play();var e=this.convertPos(t.getLocation());e.mag()<300?this.beatDon(e.x):this.beatKstsu(e.x)},e.prototype.bgClick=function(t){t.stopPropagation(),this.beat.play();var e=this.convertPos(t.getLocation());this.beatKstsu(e.x)},__decorate([a(cc.Node)],e.prototype,"don_left",void 0),__decorate([a(cc.Node)],e.prototype,"don_right",void 0),__decorate([a(cc.Node)],e.prototype,"katsu_left",void 0),__decorate([a(cc.Node)],e.prototype,"katsu_right",void 0),__decorate([a({type:cc.AudioClip})],e.prototype,"don",void 0),__decorate([a({type:cc.AudioClip})],e.prototype,"katsu",void 0),__decorate([a(cc.Node)],e.prototype,"bg",void 0),__decorate([a(cc.Animation)],e.prototype,"beat",void 0),__decorate([a(i.Pipeline)],e.prototype,"pipeline",void 0),e=__decorate([c],e)}(cc.Component);o.default=s,cc._RF.pop()},{"./pipeline":"pipeline"}]},{},["Audio","Beat","Chibi","Game","main","pipeline","taiko"]);