__require=function t(e,k,g){function b(d,c){if(!k[d]){if(!e[d]){var a=d.split("/");if(a=a[a.length-1],!e[a]){var n="function"==typeof __require&&__require;if(!c&&n)return n(a,!0);if(l)return l(a,!0);throw Error("Cannot find module '"+d+"'");}}c=k[d]={exports:{}};e[d][0].call(c.exports,function(a){return b(e[d][1][a]||a)},c,c.exports,t,e,k,g)}return k[d].exports}for(var l="function"==typeof __require&&__require,d=0;d<g.length;d++)b(g[d]);return b}({Chibi:[function(e,k,g){function f(d){d.runAction(cc.sequence([g.Chibi.$jumpAction$.clone(),
    cc.callFunc(function(){b[d.name].put(d)})]))}cc._RF.push(k,"6272bGXWwxPrIM7GQrDZtJi","Chibi");Object.defineProperty(g,"__esModule",{value:!0});var b={},l={takoyaki:function(d){d.getComponent(cc.Animation).play(["sosu","shoyu","sosu_tsumayoji","shoyu_tsumayoji"][Math.max(0,Math.floor(4*Math.random()-.1))]);f(d)},tamashi:function(d){var b=d.getComponent(cc.Animation);b.play("grow");b.scheduleOnce(function(){b.play("loop")},1);f(d)}};g.Chibi={$jumpAction$:null,$prefab$:{},$create$:function(d,e){d in
    b||(b[d]=new cc.NodePool);var c=0<b[d].size()?b[d].get():cc.instantiate(g.Chibi.$prefab$[d]);l[d](c);c.parent=e}};cc._RF.pop()},{}],Game:[function(e,k,g){cc._RF.push(k,"6a41b/Vj4tNrYWl/hCxHzUH","Game");Object.defineProperty(g,"__esModule",{value:!0});g.Game={$WIN_WIDTH$:0,$SPEED$:300,$song$:null,$TARGET_X$:412,$TARGET_Y$:94,$RADIUS$:35,$RADIUS_BIG$:53,$BAD_RANGE$:.2,$OK_RANGE$:.15,$GOOD_RANGE$:.08,$music$:null};cc._RF.pop()},{}],Note:[function(e,k,g){cc._RF.push(k,"773b2dLSY1M3pvhLHGV+KEW","Note");
    Object.defineProperty(g,"__esModule",{value:!0});var f=e("./Game");e=function(){function b(e,d,h,c){void 0===c&&(c=!1);this.$pipeline$=this.$node$=null;this.$recycleTime$=this.$endTime$=this.$startTime$=this.$time$=0;this.$type$="don";this.$big$=!1;this.$node$=cc.instantiate(b.$Prefab$);this.$type$=d;this.$big$=c;this.$pipeline$=h;this.$node$.opacity=255;this.$node$.scale=c?.7571:.5;this.$node$.getComponent(cc.Sprite).spriteFrame="don"==d?b.$DonFrame$:b.$KatsuFrame$;this.$time$=e;this.$startTime$=
    e-f.Game.$BAD_RANGE$;this.$endTime$=e+f.Game.$BAD_RANGE$;this.$recycleTime$=e+(f.Game.$TARGET_X$-330+(c?f.Game.$RADIUS_BIG$:f.Game.$RADIUS$))/f.Game.$SPEED$;this.$node$.active=!1}return b.prototype.$born$=function(){this.$node$.parent=this.$pipeline$.line;this.$node$.position=cc.v2(f.Game.$TARGET_X$+this.$time$*f.Game.$SPEED$,f.Game.$TARGET_Y$);this.$node$.active=!0},b.prototype.$done$=function(){var e=this;this.$node$.stopAllActions();this.$node$.runAction(cc.sequence([b.$doneAction$.clone(),cc.callFunc(function(){e.$pipeline$.$fade$()}),
    cc.fadeOut(.5),cc.callFunc(function(){e.$recycle$()})]))},b.prototype.$beat$=function(b,d){if(this.$type$==b){b=Math.abs(this.$time$-this.$pipeline$.$time$);if(b<f.Game.$GOOD_RANGE$)return this.$pipeline$.$good$(),this.$endTime$=0,void this.$recycle$();if(b<f.Game.$OK_RANGE$)return this.$pipeline$.$ok$(),this.$endTime$=0,void this.$recycle$();this.$pipeline$.$bad$();this.$endTime$=this.$startTime$}},b.prototype.$recycle$=function(){this.$node$&&(0!=this.$endTime$&&this.$pipeline$.$miss$(),this.$node$.destroy(),
    this.$node$=null)},b.$Prefab$=null,b.$DonFrame$=null,b.$KatsuFrame$=null,b.$doneAction$=null,b}();g.Note=e;e=function(){function b(e,d,h,c){void 0===c&&(c=!1);this.$type$="renda";this.$big$=!1;this.$pipeline$=this.$node$=null;this.$recycleTime$=this.$endTime$=this.$startTime$=0;this.$node$=cc.instantiate(b.$Prefab$);this.$big$=c;this.$pipeline$=h;this.$node$.scale=c?.7571:.5;this.$startTime$=e;this.$endTime$=d;this.$recycleTime$=d+(f.Game.$TARGET_X$-330+(c?f.Game.$RADIUS_BIG$:f.Game.$RADIUS$))/f.Game.$SPEED$;
    this.$node$.width=(70+(d-e)*f.Game.$SPEED$)/(c?.7571:.5);this.$node$.active=!1}return b.prototype.$born$=function(){this.$node$.parent=this.$pipeline$.line;this.$node$.position=cc.v2(f.Game.$TARGET_X$+this.$startTime$*f.Game.$SPEED$,f.Game.$TARGET_Y$);this.$node$.active=!0},b.prototype.$beat$=function(b,d){this.$pipeline$.$renda$()},b.prototype.$recycle$=function(){this.$node$.destroy()},b.$Prefab$=null,b}();g.Renda=e;cc._RF.pop()},{"./Game":"Game"}],main:[function(e,k,g){cc._RF.push(k,"e1b90/rohdEk4SdmmEZANaD",
    "main");Object.defineProperty(g,"__esModule",{value:!0});var f=e("./Chibi"),b=e("./Note"),l=e("./Game");e=cc._decorator;var d=e.ccclass,h=e.property;e=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;return a.nod=null,a.beatPrefab=null,a.rendaPrefab=null,a.donFrame=null,a.katsuFrame=null,a.takoyakiPrefab=null,a.tamashiPrefab=null,a}return __extends(a,c),a.prototype.onLoad=function(){cc.audioEngine.setEffectsVolume(.66);b.Note.$Prefab$=this.beatPrefab;b.Note.$DonFrame$=this.donFrame;
    b.Note.$KatsuFrame$=this.katsuFrame;b.Renda.$Prefab$=this.rendaPrefab;f.Chibi.$prefab$.takoyaki=this.takoyakiPrefab;f.Chibi.$prefab$.tamashi=this.tamashiPrefab;this.nod.runAction(cc.sequence([cc.moveBy(4,-332.6,0),cc.moveBy(0,332.6,0)]).repeatForever());l.Game.$WIN_WIDTH$=cc.view.getVisibleSize().width;for(var a=(l.Game.$WIN_WIDTH$-330+40)/6,c=[],d=0;8>=d;d++)c.push(cc.v2(330+d*a,1==d%2?225:280));f.Chibi.$jumpAction$=cc.cardinalSplineTo(2,c,0);b.Note.$doneAction$=cc.jumpTo(.6,l.Game.$WIN_WIDTH$-50-
    39,211,240,1)},__decorate([h(cc.Node)],a.prototype,"nod",void 0),__decorate([h(cc.Prefab)],a.prototype,"beatPrefab",void 0),__decorate([h(cc.Prefab)],a.prototype,"rendaPrefab",void 0),__decorate([h(cc.SpriteFrame)],a.prototype,"donFrame",void 0),__decorate([h(cc.SpriteFrame)],a.prototype,"katsuFrame",void 0),__decorate([h(cc.Prefab)],a.prototype,"takoyakiPrefab",void 0),__decorate([h(cc.Prefab)],a.prototype,"tamashiPrefab",void 0),a=__decorate([d],a)}(cc.Component);g.default=e;cc._RF.pop()},{"./Chibi":"Chibi",
    "./Game":"Game","./Note":"Note"}],pipeline:[function(e,k,g){cc._RF.push(k,"0a4b27PV9lAsZvkNDkH39Ji","pipeline");Object.defineProperty(g,"__esModule",{value:!0});k=cc._decorator;var f=k.ccclass,b=k.property,l=e("./Chibi"),d=e("./Note"),h=e("./Game");e=function(c){function a(){var a=null!==c&&c.apply(this,arguments)||this;return a.chibiLine=null,a.badLine=null,a.line=null,a.shader=null,a.result=null,a.scoreAnim=null,a.scoreTotal=null,a.scorePlus=null,a.rendaAnim=null,a.rendaTotal=null,a.comboAnim=null,
    a.comboTotal=null,a.fadeAnim=null,a.$time$=0,a.$notes$=[],a.$score$=0,a.$rendas$=0,a.$combos$=0,a.$playing$=!1,a.$lastRenda$=0,a.$ACT_RANGE$=0,a.$act_offset$=0,a.$lastUpdate$=0,a.$songID$=0,a}var e;return __extends(a,c),e=a,a.prototype.$beat$=function(a,b){if(this.$playing$){this.shader.stopAllActions();this.shader.opacity=80;this.shader.color="don"==a?e.$DonColor$:e.$KatsuColor$;this.shader.runAction(cc.fadeOut(.3));for(var d=0;d<this.$notes$.length;d++){var c=this.$notes$[d];if(this.$time$<c.$startTime$)break;
    if(this.$time$<c.$endTime$){c.$beat$(a,b);break}}}else this.$play$()},a.prototype.$plus$=function(a){this.$score$+=a;this.scorePlus.string=String(a);this.scoreTotal.string=String(this.$score$);this.scoreAnim.play("score_plus")},a.prototype.$comboPlus$=function(){this.$combos$++;10<=this.$combos$&&(this.comboTotal.node.opacity=255,this.comboAnim.play("combo_plus"),this.comboTotal.string=String(this.$combos$))},a.prototype.$comboClear$=function(){0!=this.$combos$&&(this.$combos$=0,this.comboTotal.node.opacity=
    0)},a.prototype.$ok$=function(){this.$plus$(100);this.$comboPlus$();this.result.play(this.$notes$[0].$big$?"big_ok":"ok");l.Chibi.$create$("takoyaki",this.chibiLine)},a.prototype.$bad$=function(){this.$comboClear$();this.result.play("bad");l.Chibi.$create$("tamashi",this.badLine)},a.prototype.$good$=function(){this.$plus$(200);this.$comboPlus$();this.result.play(this.$notes$[0].$big$?"big_good":"good");l.Chibi.$create$("takoyaki",this.chibiLine)},a.prototype.$miss$=function(){this.$comboClear$();
    l.Chibi.$create$("tamashi",this.badLine)},a.prototype.$renda$=function(){this.$plus$(100);0==this.$rendas$?this.rendaAnim.play("renda_fan").wrapMode=cc.WrapMode.Normal:this.rendaAnim.play("renda_plus");this.$lastRenda$=this.$time$;this.$rendas$++;this.rendaTotal.string=String(this.$rendas$)},a.prototype.$fade$=function(){this.fadeAnim.play("fade")},a.prototype.start=function(){var a=this;this.$ACT_RANGE$=(h.Game.$WIN_WIDTH$+h.Game.$RADIUS_BIG$)/h.Game.$SPEED$;cc.loader.loadRes("tja",cc.TextAsset,
    function(d,b){h.Game.$music$=b.text;a.$parse$()});cc.loader.loadRes("music",cc.AudioClip,function(a,b){h.Game.$song$=b});this.$init$()},a.prototype.$init$=function(){this.$score$=0;this.scoreTotal.string="0";this.$rendas$=0;this.$combos$=this.rendaAnim.node.opacity=0;this.comboAnim.node.opacity=0;this.line.position=cc.v2(0,0);this.$playing$=!1;this.$lastUpdate$=this.$time$=this.$act_offset$=0},a.prototype.update=function(a){var b=this;if(this.$playing$){if(0==this.$time$){if(this.$time$=Number(cc.audioEngine.getCurrentTime(this.$songID$)),
    0==this.$time$)return;this.scheduleOnce(function(){b.$init$();b.$parse$();l.Chibi.$create$("takoyaki",b.chibiLine)},Number(cc.audioEngine.getDuration(this.$songID$)));this.line.x=-this.$time$*h.Game.$SPEED$}else this.$time$+=a,this.line.x-=a*h.Game.$SPEED$;if(!(.1>this.$time$-this.$lastUpdate$)){this.$lastUpdate$=this.$time$;for(0<this.$lastRenda$&&1<this.$time$-this.$lastRenda$&&(this.rendaAnim.play("renda_fan").wrapMode=cc.WrapMode.Reverse,this.$rendas$=0,this.$lastRenda$=0);(d=this.$notes$[0])&&
    !(d.$recycleTime$>this.$time$);)d.$recycle$(),this.$notes$.shift(),this.$act_offset$--;for(a=this.$act_offset$;a<this.$notes$.length;a++){var d;if((d=this.$notes$[a]).$startTime$>this.$time$+this.$ACT_RANGE$)break;d.$node$&&null==d.$node$.parent&&(d.$born$(),this.$act_offset$++)}}}},a.prototype.$parse$=function(){var a=this,b=h.Game.$music$.split("\n");this.$notes$=[];var c=0,e=80,f="",n=0,g=[],k=4,l=!1;b.forEach(function(b){if(!l)if("9">=(b=b.trim().split("//")[0])[0]&&"0"<=b[0]){for(var h=b.split(",")[0],
    m=0;m<h.length;m++)g.push({type:h[m],bpm:e});if(-1!=b.indexOf(",")){b=g.length;if(0==b)return void(c+=60/e*k);for(m=0;m<b;m++){h=g[m];switch(h.type){case "1":a.$notes$.push(new d.Note(c,"don",a));break;case "2":a.$notes$.push(new d.Note(c,"katsu",a));break;case "3":a.$notes$.push(new d.Note(c,"don",a,!0));break;case "4":a.$notes$.push(new d.Note(c,"katsu",a,!0));break;case "5":if(""!=f)continue;f="5";n=c;break;case "6":if(""!=f)continue;f="6";n=c;break;case "8":if(""==f)continue;a.$notes$.push(new d.Renda(n,
    c,a,"6"==f));f=""}c+=60/h.bpm/b*k}g=[]}}else if("#"!=b[0])switch(m=b.split(":"),m[0]){case "OFFSET":c=-parseFloat(m[1]);break;case "BPM":e=parseFloat(m[1])}else switch(m=b.slice(1).split(" "),m[0]){case "BPMCHANGE":e=parseFloat(m[1]);break;case "MEASURE":m=m[1].split("/");k=parseFloat(m[0])/parseFloat(m[1])*4;break;case "END":l=!0}})},a.prototype.$play$=function(){null!=h.Game.$song$&&null!=h.Game.$music$&&(this.$playing$=!0,this.$songID$=cc.audioEngine.playMusic(h.Game.$song$,!1))},a.$DonColor$=
    cc.color(247,73,38),a.$KatsuColor$=cc.color(106,192,193),__decorate([b(cc.Node)],a.prototype,"chibiLine",void 0),__decorate([b(cc.Node)],a.prototype,"badLine",void 0),__decorate([b(cc.Node)],a.prototype,"line",void 0),__decorate([b(cc.Node)],a.prototype,"shader",void 0),__decorate([b(cc.Animation)],a.prototype,"result",void 0),__decorate([b(cc.Animation)],a.prototype,"scoreAnim",void 0),__decorate([b(cc.Label)],a.prototype,"scoreTotal",void 0),__decorate([b(cc.Label)],a.prototype,"scorePlus",void 0),
    __decorate([b(cc.Animation)],a.prototype,"rendaAnim",void 0),__decorate([b(cc.Label)],a.prototype,"rendaTotal",void 0),__decorate([b(cc.Animation)],a.prototype,"comboAnim",void 0),__decorate([b(cc.Label)],a.prototype,"comboTotal",void 0),__decorate([b(cc.Animation)],a.prototype,"fadeAnim",void 0),a=e=__decorate([f],a)}(cc.Component);g.Pipeline=e;cc._RF.pop()},{"./Chibi":"Chibi","./Game":"Game","./Note":"Note"}],taiko:[function(e,k,g){cc._RF.push(k,"8f87e2O75FPmZ4crphzlfVZ","taiko");Object.defineProperty(g,
    "__esModule",{value:!0});var f=e("./Game"),b=e("./pipeline");e=cc._decorator;var l=e.ccclass,d=e.property;e=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;return a.don_left=null,a.don_right=null,a.katsu_left=null,a.katsu_right=null,a.don=null,a.katsu=null,a.bg=null,a.beat=null,a.pipeline=null,a}var a;return __extends(c,e),a=c,c.prototype.$onKeyDown$=function(a){switch(a.keyCode){case cc.macro.KEY.d:this.$beatKstsuLeft$();break;case cc.macro.KEY.f:this.$beatDonLeft$();break;
    case cc.macro.KEY.j:this.$beatDonRight$();break;case cc.macro.KEY.k:this.$beatKstsuRight$()}},c.prototype.onEnable=function(){this.don_left.opacity=0;this.don_right.opacity=0;this.katsu_left.opacity=0;this.katsu_right.opacity=0;this.node.on(cc.Node.EventType.TOUCH_START,this.$taikoClick$,this);this.bg.on(cc.Node.EventType.TOUCH_START,this.$bgClick$,this);cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.$onKeyDown$,this)},c.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,
    this.$taikoClick$,this);this.bg.off(cc.Node.EventType.TOUCH_START,this.$bgClick$,this)},c.prototype.convertPos=function(a){return cc.v2(a.x-f.Game.$WIN_WIDTH$/2,a.y)},c.prototype.$beatDon$=function(){this.beat.play();cc.audioEngine.playEffect(this.don,!1)},c.prototype.$beatDonLeft$=function(){this.$beatDon$();this.don_left.opacity=255;this.don_left.runAction(a.$beatAction$.clone());this.pipeline.$beat$("don","left")},c.prototype.$beatDonRight$=function(){this.$beatDon$();this.don_right.opacity=255;
    this.don_right.runAction(a.$beatAction$.clone());this.pipeline.$beat$("don","right")},c.prototype.$beatKstsu$=function(){this.beat.play();cc.audioEngine.playEffect(this.katsu,!1)},c.prototype.$beatKstsuLeft$=function(){this.$beatKstsu$();this.katsu_left.opacity=255;this.katsu_left.runAction(a.$beatAction$.clone());this.pipeline.$beat$("katsu","left")},c.prototype.$beatKstsuRight$=function(){this.$beatKstsu$();this.katsu_right.opacity=255;this.katsu_right.runAction(a.$beatAction$.clone());this.pipeline.$beat$("katsu",
    "right")},c.prototype.$taikoClick$=function(a){a.stopPropagation();a=this.convertPos(a.getLocation());300>a.mag()?0>a.x?this.$beatDonLeft$():this.$beatDonRight$():0>a.x?this.$beatKstsuLeft$():this.$beatKstsuRight$()},c.prototype.$bgClick$=function(a){a.stopPropagation();0>this.convertPos(a.getLocation()).x?this.$beatKstsuLeft$():this.$beatKstsuRight$()},c.$beatAction$=cc.fadeOut(.25),__decorate([d(cc.Node)],c.prototype,"don_left",void 0),__decorate([d(cc.Node)],c.prototype,"don_right",void 0),__decorate([d(cc.Node)],
    c.prototype,"katsu_left",void 0),__decorate([d(cc.Node)],c.prototype,"katsu_right",void 0),__decorate([d({type:cc.AudioClip})],c.prototype,"don",void 0),__decorate([d({type:cc.AudioClip})],c.prototype,"katsu",void 0),__decorate([d(cc.Node)],c.prototype,"bg",void 0),__decorate([d(cc.Animation)],c.prototype,"beat",void 0),__decorate([d(b.Pipeline)],c.prototype,"pipeline",void 0),c=a=__decorate([l],c)}(cc.Component);g.default=e;cc._RF.pop()},{"./Game":"Game","./pipeline":"pipeline"}]},{},"Chibi Game Note main pipeline taiko".split(" "));